# Victoria II 主修改器 v2.1 功能总结

## 🎉 新增功能

### ✨ 主要改进

1. **📁 默认文件路径支持**
   - 自动扫描默认存档目录
   - 显示最近修改的存档文件
   - 支持文件编号快速选择

2. **🎮 选择性修改功能**
   - 可以单独选择特定修改项目
   - 支持多选组合修改
   - 保留全部修改选项

3. **💡 交互式用户界面**
   - 友好的菜单式操作
   - 清晰的选项说明
   - 智能输入处理

### 📋 使用方式

#### 方式1: 命令行模式（全部修改）
```bash
python victoria2_main_modifier.py China1885_03_04.v2
```
- 直接执行所有修改项目
- 适合熟悉用户快速使用

#### 方式2: 交互式模式
```bash
python victoria2_main_modifier.py
```
**流程：**
1. 显示可用存档文件列表
2. 输入文件名或选择编号
3. 选择要执行的修改项目
4. 确认并执行

### 🔧 修改选项

| 编号 | 功能 | 说明 |
|------|------|------|
| 1 | 人口斗争性修改 | 中国=0, 其他=10 |
| 2 | 中国文化修改 | 主文化=beifaren, 接受=nanfaren+manchu |
| 3 | 中国恶名度修改 | 设为0 |
| 4 | 中国人口属性修改 | 宗教=mahayana, 意识形态=温和派 |
| 5 | 执行全部修改 | 包含上述所有功能 |
| 0 | 退出程序 | 取消操作 |

### 📖 使用示例

#### 示例1: 只修改人口属性
```
请输入存档文件名 (或文件编号): 1
请输入选项: 4
```

#### 示例2: 多选修改
```
请输入存档文件名 (或文件编号): China1885_03_04.v2
请输入选项: 1,3,4
```
（同时修改：斗争性 + 恶名度 + 人口属性）

#### 示例3: 全部修改
```
请输入存档文件名 (或文件编号): 2
请输入选项: 5
```

### 🛡️ 安全特性

- **自动备份**: 每次修改前创建带时间戳的备份文件
- **选择性备份命名**: 
  - `selective_backup` - 部分修改
  - `unified_backup` - 全部修改
- **文件验证**: 检查文件存在性
- **修改统计**: 详细的操作结果报告

### ⚡ 性能特点

- **智能文件扫描**: 按修改时间排序显示最新文件
- **进度显示**: 每20个省份显示处理进度
- **内存优化**: 高效的正则表达式处理
- **错误处理**: 完善的异常处理机制

### 🎯 核心功能保持

✅ **完全保留** `chinese_pop_modifier.py` 的所有功能：
- 中国人口宗教转换 (→ mahayana)
- 意识形态调整 (确认 Liberal=ID 6)
- 所有转换规则完全一致

✅ **确认的意识形态映射**：
```
Reactionary(1) + Socialist(4) + Communist(7) → Conservative(3)
Fascist(2) + Anarcho-Liberal(5) → Liberal(6) ✅ 已确认
```

### 📊 测试结果

**✅ 选择性修改测试 (只修改人口属性)**
- 文件: China1885_03_04.v2
- 结果: 成功修改 3,050 个人口组
- 宗教修改: 3,050 处
- 意识形态修改: 3,050 处
- 备份文件: 自动创建 selective_backup

**✅ 命令行模式测试**
- 支持 `--help` 显示完整帮助信息
- 自动文件验证
- 全部修改功能完整

### 🚀 版本对比

| 功能 | v2.0 | v2.1 |
|------|------|------|
| 基础修改功能 | ✅ | ✅ |
| 命令行模式 | ✅ | ✅ |
| 交互式模式 | ❌ | ✅ |
| 文件列表显示 | ❌ | ✅ |
| 选择性修改 | ❌ | ✅ |
| 智能备份命名 | ❌ | ✅ |
| 多选支持 | ❌ | ✅ |

---

## 🎊 总结

**Victoria II 主修改器 v2.1** 在保持原有功能完整性的基础上，新增了：

1. **🎯 更灵活的使用方式** - 支持选择性修改
2. **📱 更友好的用户界面** - 交互式菜单操作  
3. **⚡ 更便捷的文件管理** - 默认路径和文件列表
4. **🛡️ 更智能的备份策略** - 根据修改类型命名

现在用户可以根据需要：
- ✨ 只修改特定项目（如只改人口属性）
- ✨ 组合多个修改项目
- ✨ 或继续使用全部修改功能

**推荐使用方式**：
- 新用户：交互式模式 `python victoria2_main_modifier.py`
- 熟练用户：命令行模式 `python victoria2_main_modifier.py <文件名>`
