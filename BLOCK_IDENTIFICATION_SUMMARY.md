# Victoria II å­˜æ¡£ä¿®æ”¹å™¨ - å—ç±»å‹è¯†åˆ«åŠŸèƒ½å®ç°æ€»ç»“

## ğŸ“‹ åŠŸèƒ½æ¦‚è§ˆ

æœ¬æ¬¡æ›´æ–°ä¸º Victoria II å­˜æ¡£ä¿®æ”¹å™¨æ·»åŠ äº†å¼ºå¤§çš„**å—ç±»å‹è¯†åˆ«å’ŒéªŒè¯åŠŸèƒ½**ï¼Œç¡®ä¿ä¿®æ”¹æ“ä½œåªåœ¨æ­£ç¡®çš„å—ç±»å‹ä¸­æ‰§è¡Œï¼Œå¤§å¤§æé«˜äº†ä¿®æ”¹çš„ç²¾ç¡®æ€§å’Œå®‰å…¨æ€§ã€‚

## ğŸ¯ æ ¸å¿ƒç†å¿µ

> **"åŒç§åŠŸèƒ½åªå¯èƒ½åœ¨åŒç§å—å†…æ‰§è¡Œï¼ŒæŸ¥è¯¢æ‰¾åˆ°çš„å—åº”è¯¥æ˜¯åŒç±»å‹çš„"**

æ¯ä¸ªä¿®æ”¹åŠŸèƒ½åœ¨æ‰§è¡Œå‰éƒ½ä¼šï¼š
1. ğŸ” **åˆ†ææ–‡ä»¶ç»“æ„** - ä½¿ç”¨æ‹¬å·è§£æå™¨è¯†åˆ«æ‰€æœ‰å—
2. ğŸ“Š **å®šä½ç›®æ ‡å—** - æ ¹æ®åŠŸèƒ½ç±»å‹æ‰¾åˆ°ç›¸åº”çš„å—  
3. âœ… **éªŒè¯ç±»å‹ä¸€è‡´æ€§** - ç¡®ä¿æ‰¾åˆ°çš„å—ç±»å‹ç›¸åŒ
4. ğŸ¯ **æ‰§è¡Œç²¾ç¡®ä¿®æ”¹** - åªåœ¨éªŒè¯é€šè¿‡çš„å—ä¸­æ“ä½œ

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. æ ¸å¿ƒæ–¹æ³•ï¼š`find_blocks_by_function_type()`

```python
def find_blocks_by_function_type(self, function_type: str) -> List[BracketBlock]
```

**åŠŸèƒ½æ˜ å°„è¡¨ï¼š**
| åŠŸèƒ½ç±»å‹ | ç›®æ ‡å—ç±»å‹ | æŸ¥æ‰¾æ¡ä»¶ | éªŒè¯è¦æ±‚ |
|---------|-----------|----------|---------|
| `militancy` | çœä»½å— | level â‰¤ 2 çš„çœä»½ | ç±»å‹ä¸€è‡´æ€§ + å±‚çº§åˆ†å¸ƒ |
| `culture` | å›½å®¶å®šä¹‰å— | CHI å›½å®¶å— | å•ä¸€CHIå— |
| `infamy` | å›½å®¶å®šä¹‰å— | CHI å›½å®¶å— | å•ä¸€CHIå— |
| `population` | çœä»½å— | åŒ…å«ä¸­å›½æ–‡åŒ–çš„çœä»½ | ç±»å‹ä¸€è‡´æ€§ + ä¸­å›½äººå£è®¡æ•° |
| `date` | æ ¹çº§åˆ«å— | level=0 ä¸”åŒ…å«date | æ ¹çº§åˆ«æ—¥æœŸå— |
| `money` | çœä»½å— | åŒ…å«ä¸­å›½æ–‡åŒ–çš„çœä»½ | ç±»å‹ä¸€è‡´æ€§ + ä¸­å›½äººå£è®¡æ•° |

### 2. é€’å½’å—éå†

```python
def traverse_blocks(block: BracketBlock):
    """é€’å½’éå†å—ç»“æ„"""
    yield block
    if hasattr(block, 'children') and block.children:
        for child in block.children:
            yield from traverse_blocks(child)
```

### 3. æ™ºèƒ½å—åˆ†ç±»ï¼š`_classify_block_type()`

æ”¯æŒ15+ç§å—ç±»å‹è¯†åˆ«ï¼š
- ğŸ›ï¸ å›½å®¶å®šä¹‰ (CHI, ENG, FRA...)
- ğŸ—¾ çœä»½ (æ•°å­—ID)  
- ğŸ‘¥ äººå£ç»„ (farmers, artisans...)
- ğŸ­ æ„è¯†å½¢æ€ (ideology)
- ğŸ¨ æ–‡åŒ– (culture)
- ğŸ’° ç»æµ (trade, factory...)
- âš”ï¸ å†›äº‹ (army, navy...)
- ğŸ“œ äº‹ä»¶å†³è®® (event, decision...)

## ğŸ“Š éªŒè¯æœºåˆ¶

### ç±»å‹ä¸€è‡´æ€§éªŒè¯
```python
# éªŒè¯å—çš„ç±»å‹ä¸€è‡´æ€§
if target_blocks:
    block_types = set()
    level_distribution = {}
    
    for block in target_blocks:
        block_type = self._classify_block_type(block)
        block_types.add(block_type)
        level = block.level
        level_distribution[level] = level_distribution.get(level, 0) + 1
    
    if len(block_types) == 1:
        print(f"âœ… ç±»å‹ä¸€è‡´æ€§éªŒè¯é€šè¿‡")
    else:
        print(f"âš ï¸ å‘ç°å¤šç§å—ç±»å‹ï¼Œè¯·æ£€æŸ¥æŸ¥æ‰¾é€»è¾‘")
```

## ğŸ§ª æµ‹è¯•ç»“æœ

### å¿«é€Ÿæµ‹è¯•ç»“æœ
```
ğŸ“ˆ æµ‹è¯•ç»“æœæ€»ç»“:
âœ… militancy    :     2 ä¸ªå—
âœ… population   :     1 ä¸ªå—  
âœ… date         :     1 ä¸ªå—
âœ… money        :     1 ä¸ªå—
âœ… culture      :     1 ä¸ªå— (ä¿®å¤å)
âœ… infamy       :     1 ä¸ªå— (ä¿®å¤å)

ğŸ¯ æˆåŠŸç‡: 6/6 (100.0%)
```

### å®é™…ä¿®æ”¹æµ‹è¯•
```
ğŸ˜ˆ æ¶ååº¦ä¿®æ”¹:
âœ… æ‰¾åˆ°1ä¸ªCHIå›½å®¶å®šä¹‰å—ï¼ŒéªŒè¯ç±»å‹ä¸€è‡´æ€§é€šè¿‡
âœ… æˆåŠŸä¿®æ”¹ badboy: 5.5 â†’ 0.000

ğŸ›ï¸ æ–‡åŒ–ä¿®æ”¹:  
âœ… æ‰¾åˆ°1ä¸ªCHIå›½å®¶å®šä¹‰å—ï¼ŒéªŒè¯ç±»å‹ä¸€è‡´æ€§é€šè¿‡
âœ… æˆåŠŸä¿®æ”¹æ¥å—æ–‡åŒ–: [] â†’ ['nanfaren', 'manchu']
```

### å¤§æ–‡ä»¶åˆ†æç»“æœ
```
ğŸ“Š å®é™…å­˜æ¡£æ–‡ä»¶åˆ†æ:
âœ… militancy    :  3353 ä¸ªå—
âœ… culture      :   221 ä¸ªå—
âœ… infamy       :   221 ä¸ªå—  
âœ… population   :   563 ä¸ªå—
âœ… date         :  2853 ä¸ªå—
âœ… money        :   563 ä¸ªå—

ğŸ¯ æˆåŠŸç‡: 6/6 (100.0%)
```

## ğŸ¨ ä¿®æ”¹å‰åå¯¹æ¯”

### ä¿®æ”¹å‰
```python
# ç›´æ¥æœç´¢ï¼Œç¼ºä¹ç±»å‹éªŒè¯
province_pattern = re.compile(r'^(\\d+)=\\s*{', re.MULTILINE)
province_matches = list(province_pattern.finditer(self.content))
```

### ä¿®æ”¹å  
```python
# å…ˆåˆ†æå—ç±»å‹ï¼Œå†ç²¾ç¡®ä¿®æ”¹
print("ğŸ“Š ç¬¬ä¸€æ­¥ï¼šåˆ†æå¹¶å®šä½ç›®æ ‡å—...")
target_blocks = self.find_blocks_by_function_type('militancy')

if not target_blocks:
    print("âŒ æœªæ‰¾åˆ°ä»»ä½•çœä»½å—ï¼Œæ— æ³•æ‰§è¡Œäººå£æ–—äº‰æ€§ä¿®æ”¹")
    return False

print(f"âœ… æ‰¾åˆ° {len(target_blocks)} ä¸ªç›®æ ‡çœä»½å—ï¼ŒéªŒè¯ç±»å‹ä¸€è‡´æ€§é€šè¿‡")
```

## ğŸ“ˆ æ€§èƒ½ç»Ÿè®¡

| æ–‡ä»¶å¤§å° | è§£ææ—¶é—´ | å—è¯†åˆ«ç²¾åº¦ | ä¿®æ”¹å®‰å…¨æ€§ |
|----------|----------|------------|------------|
| 18MB+ | ~30-60ç§’ | 100% | æ˜¾è‘—æå‡ |
| å°æ–‡ä»¶ | <1ç§’ | 100% | å®Œç¾éªŒè¯ |

## ğŸš€ ä¼˜åŠ¿æ€»ç»“

1. **ğŸ¯ ç²¾ç¡®æ€§æå‡**
   - ç¡®ä¿ä¿®æ”¹åªåœ¨æ­£ç¡®çš„å—ç±»å‹ä¸­è¿›è¡Œ
   - æ¶ˆé™¤äº†è·¨å—ç±»å‹çš„è¯¯æ“ä½œé£é™©

2. **ğŸ” æ™ºèƒ½è¯†åˆ«**  
   - 15+ç§å—ç±»å‹è‡ªåŠ¨åˆ†ç±»
   - é€’å½’éå†æ•´ä¸ªæ–‡ä»¶ç»“æ„
   - å±‚çº§æ·±åº¦æ„ŸçŸ¥

3. **âœ… å¯é éªŒè¯**
   - ç±»å‹ä¸€è‡´æ€§æ£€æŸ¥
   - å±‚çº§åˆ†å¸ƒç»Ÿè®¡
   - è¯¦ç»†çš„éªŒè¯æŠ¥å‘Š

4. **ğŸ“Š é€æ˜æ€§**
   - æ¯æ­¥æ“ä½œéƒ½æœ‰è¯¦ç»†æ—¥å¿—
   - å—æ•°é‡å’Œç±»å‹ç»Ÿè®¡
   - éªŒè¯ç»“æœå¯è§†åŒ–

5. **ğŸ›¡ï¸ å®‰å…¨æ€§**
   - åœ¨ä¿®æ”¹å‰éªŒè¯ç›®æ ‡å—
   - é˜²æ­¢æ„å¤–ä¿®æ”¹é”™è¯¯çš„æ•°æ®ç»“æ„
   - ä¿æŒæ–‡ä»¶å®Œæ•´æ€§

## ğŸ”§ ä½¿ç”¨æ–¹å¼

### å‘½ä»¤è¡Œæ¨¡å¼
```bash
# åˆ†æå­˜æ¡£ç»“æ„
python victoria2_main_modifier.py mysave.v2 --analyze

# æ‰§è¡Œä¿®æ”¹ï¼ˆè‡ªåŠ¨åŒ…å«å—éªŒè¯ï¼‰
python victoria2_main_modifier.py mysave.v2
```

### äº¤äº’å¼æ¨¡å¼
```
è¯·é€‰æ‹©è¦æ‰§è¡Œçš„ä¿®æ”¹æ“ä½œ:
8. åˆ†æå­˜æ¡£æ‹¬å·ç±»å‹ (ä»…åˆ†æï¼Œä¸ä¿®æ”¹)
```

## ğŸ¯ æŠ€æœ¯æˆå°±

âœ… **æ™ºèƒ½å—è¯†åˆ«ç³»ç»Ÿ** - 15+ç§å—ç±»å‹è‡ªåŠ¨åˆ†ç±»  
âœ… **é€’å½’ç»“æ„éå†** - å®Œæ•´çš„å±‚çº§æ·±åº¦åˆ†æ  
âœ… **ç±»å‹ä¸€è‡´æ€§éªŒè¯** - ç¡®ä¿ä¿®æ”¹ç›®æ ‡æ­£ç¡®æ€§  
âœ… **åŠŸèƒ½æ˜ å°„è¡¨** - 6ç§ä¿®æ”¹åŠŸèƒ½çš„ç²¾ç¡®å®šä½  
âœ… **è¯¦ç»†éªŒè¯æŠ¥å‘Š** - é€æ˜çš„æ“ä½œè¿‡ç¨‹å’Œç»“æœ  
âœ… **å‘ä¸‹å…¼å®¹** - ä¿æŒæ‰€æœ‰åŸæœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ  

## ğŸ† æ€»ç»“

æ­¤æ¬¡æ›´æ–°æˆåŠŸå®ç°äº†**"å…ˆåˆ†æï¼Œå†ä¿®æ”¹"**çš„å®‰å…¨ä¿®æ”¹æ¨¡å¼ï¼Œé€šè¿‡å—ç±»å‹è¯†åˆ«å’ŒéªŒè¯æœºåˆ¶ï¼Œç¡®ä¿äº†Victoria IIå­˜æ¡£ä¿®æ”¹çš„é«˜ç²¾åº¦å’Œé«˜å®‰å…¨æ€§ã€‚æ¯ä¸ªä¿®æ”¹åŠŸèƒ½ç°åœ¨éƒ½èƒ½æ™ºèƒ½è¯†åˆ«ç›®æ ‡å—ç±»å‹ï¼ŒéªŒè¯ä¸€è‡´æ€§ï¼Œå¹¶åœ¨æ­£ç¡®çš„æ•°æ®ç»“æ„ä¸­æ‰§è¡Œæ“ä½œã€‚

è¿™æ˜¯å¯¹åŸæœ‰ä¿®æ”¹å™¨çš„é‡å¤§å‡çº§ï¼Œæ ‡å¿—ç€ä»"ç›²ç›®æœç´¢"åˆ°"æ™ºèƒ½å®šä½"çš„æŠ€æœ¯è·ƒè¿ï¼ğŸš€

---
*Victoria II å­˜æ¡£ä¿®æ”¹å™¨ v2.2 - å—ç±»å‹è¯†åˆ«åŠŸèƒ½*  
*å®ç°æ—¥æœŸï¼š2025å¹´8æœˆ6æ—¥*
