# 文件选择功能使用说明

## 新增功能概述
为 `china_population_cleaner.py` 添加了智能文件选择功能，使用更加便捷。

## 启动方式

### 1. 交互式模式（推荐）
```bash
python china_population_cleaner.py
```

### 2. 命令行模式
```bash
python china_population_cleaner.py <文件名> [模式]
```

## 交互式文件选择功能

### 自动扫描
- 自动扫描当前目录下的所有 `.v2` 存档文件
- 按修改时间倒序排列（最新文件在顶部）
- 显示文件大小和修改时间

### 选择方式
1. **序号选择**: 输入 `1-8` 等数字直接选择
2. **文件名选择**: 输入完整文件名如 `ChinaUseIt.v2`
3. **智能补全**: 输入文件名不带后缀，自动补全 `.v2`
4. **退出程序**: 直接回车退出

### 示例界面
```
==================================================
选择存档文件
==================================================
找到 8 个存档文件:
=====================================================
序号   文件名                            大小(MB)     修改时间
-----------------------------------------------------
1    auto.v2                        25.6       2025-08-10 00:22:18
2    autosave.v2                    25.6       2025-08-10 00:22:18
3    China1844_09_16 - 副本 (2).v2    25.6       2025-08-10 00:22:18
4    ChinaUseIt.v2                  19.7       2025-08-09 17:46:01
-----------------------------------------------------
提示:
- 输入序号 (1-8) 选择文件
- 输入文件名 (支持自动补全 .v2 后缀)
- 直接回车退出程序

请选择文件:
```

## 运行模式选择

选择文件后，会提示选择运行模式：

```
==================================================
选择运行模式
==================================================
1. preview  - 预览模式 (仅显示清理计划，不修改文件)
2. execute  - 执行模式 (实际执行清理操作)

请选择模式 (1/2 或 preview/execute，默认: preview):
```

### 模式说明
- **预览模式** (默认): 安全分析，不修改文件，生成详细报告
- **执行模式**: 实际执行人口清理，需要确认操作

## 使用建议

### 安全操作流程
1. 首次使用建议选择 **预览模式**
2. 查看生成的清理报告
3. 确认清理计划无误后再使用 **执行模式**
4. 执行前程序会自动创建备份文件

### 快速操作
```bash
# 快速预览最新存档
python china_population_cleaner.py
# 选择 1 (最新文件)
# 回车 (默认预览模式)

# 快速执行指定文件
python china_population_cleaner.py ChinaUseIt.v2 execute
```

## 错误处理
- 文件不存在时提示重新选择
- 支持 Ctrl+C 中断操作
- 输入错误时给出明确提示
- 无存档文件时提供使用说明

## 兼容性
- 保持原有命令行参数兼容性
- 支持所有现有功能
- 向后兼容旧的使用方式
