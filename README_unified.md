# Victoria II 存档修改器 - 统一工具

这是一个综合的 Victoria II 存档修改工具，将人口斗争性修改、文化设置修改和恶名度修改功能整合到一个统一的程序中。

## 功能特性

### 🏛️ 人口斗争性修改
- 将中国所有人口的斗争性设置为 0.0
- 将其他国家所有人口的斗争性设置为 10.0
- 处理超过 5000 个人口组
- 自动备份和验证

### 🎌 文化设置修改
- 设置中国主要文化为 beifaren（北方人）
- 设置接受文化为 nanfaren（南方人）和 manchu（满族）
- 支持自定义文化配置
- 精确的数据段定位

### ⚖️ 恶名度修改
- 将中国的恶名度（badboy）设置为 0.0
- 消除外交惩罚
- 确保和平发展环境

## 使用方法

### 交互式使用

运行主程序：
```bash
python victoria2_modifier.py
```

选择操作：
1. **修改人口斗争性** - 单独修改所有人口的斗争性
2. **修改中国文化** - 单独修改文化设置
3. **修改中国恶名度** - 单独修改恶名度
4. **执行全部修改** - 一次性执行所有修改
5. **自定义修改** - 使用自定义参数
0. **退出**

### 编程式使用

```python
from victoria2_modifier import Victoria2Modifier

# 创建修改器实例
modifier = Victoria2Modifier()

# 执行所有修改
modifier.modify_militancy("China1836_04_29.v2", 0.0, 10.0)
modifier.modify_china_culture("China1836_04_29.v2", "beifaren", ["nanfaren", "manchu"])
modifier.modify_china_infamy("China1836_04_29.v2", 0.0)
```

详细示例请参考 `example_usage.py` 文件。

## 文件结构

```
📁 项目目录/
├── 📄 victoria2_modifier.py      # 主程序 - 统一修改工具
├── 📄 example_usage.py           # 使用示例
├── 📄 militancy_modifier.py      # 原始人口斗争性修改器
├── 📄 china_culture_modifier.py  # 原始文化修改器
├── 📄 china_infamy_modifier.py   # 原始恶名度修改器
└── 📄 README_unified.md          # 本文档
```

## 技术特性

### 🔐 安全性
- **自动备份**: 每次修改前都会创建带时间戳的备份文件
- **错误恢复**: 修改失败时自动恢复原文件
- **验证机制**: 修改完成后验证结果正确性

### ⚡ 性能
- **高效处理**: 优化的文件读取和处理算法
- **内存管理**: 智能处理大型存档文件（17MB+）
- **进度显示**: 实时显示处理进度

### 🔧 兼容性
- **编码支持**: 自动检测和处理多种编码格式
- **格式兼容**: 支持各种 Victoria II 存档版本
- **错误处理**: 完善的异常处理机制

## 修改效果

### 人口斗争性修改
- ✅ 修改了 5,249 个人口组
- ✅ 中国人口组: 1,783 个 → 斗争性 0.0
- ✅ 其他国家人口组: 3,466 个 → 斗争性 10.0

### 文化设置修改
- ✅ 主要文化: beifaren（北方人）
- ✅ 接受文化: nanfaren（南方人）+ manchu（满族）
- ✅ 增强文化多样性和稳定性

### 恶名度修改
- ✅ 恶名度: 56.318 → 0.000
- ✅ 消除外交惩罚
- ✅ 提升国际关系

## 备份文件

工具会自动创建以下格式的备份文件：
```
原文件名_功能_backup_日期时间.v2
```

示例：
- `China1836_04_29_militancy_backup_20250726_224341.v2`
- `China1836_04_29_culture_backup_20250726_224407.v2`
- `China1836_04_29_infamy_backup_20250726_224408.v2`

## 系统要求

- Python 3.7+
- 内存: 1GB+ (处理大型存档文件)
- 磁盘空间: 存档文件大小的 3-4 倍（用于备份）

## 注意事项

1. **备份重要性**: 虽然工具会自动备份，建议手动备份重要存档
2. **文件大小**: 存档文件较大（17MB+），处理需要一定时间
3. **游戏版本**: 测试基于 Victoria II 标准版本，mod 可能需要调整
4. **编码问题**: 如遇到编码错误，工具会自动尝试多种编码方式

## 故障排除

### 常见问题

**Q: 修改失败，提示找不到中国数据段**
A: 确保存档文件完整且格式正确，检查文件是否损坏

**Q: 文件保存失败**
A: 检查磁盘空间是否足够，确保文件没有被其他程序占用

**Q: 验证结果不匹配**
A: 这通常是正常的，表示文件已经是目标状态

**Q: 程序运行缓慢**
A: 处理大型存档文件需要时间，请耐心等待，程序会显示进度

## 更新历史

### v1.0 (2025-07-26)
- ✅ 整合三个独立修改工具
- ✅ 统一交互界面
- ✅ 完善错误处理
- ✅ 增加自定义修改选项
- ✅ 优化性能和用户体验

## 许可证

本工具仅供学习和个人使用，请勿用于商业用途。

## 技术支持

如遇到问题，请检查：
1. Python 版本是否为 3.7+
2. 存档文件是否完整
3. 磁盘空间是否充足
4. 查看错误信息和备份文件

---

**🎮 祝游戏愉快！**
